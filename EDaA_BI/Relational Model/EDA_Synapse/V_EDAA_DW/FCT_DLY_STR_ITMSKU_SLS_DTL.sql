CREATE VIEW [V_EDAA_DW].[FCT_DLY_STR_ITMSKU_SLS_DTL]
AS SELECT [PROD_HIST_SK]
      ,[GEO_HIST_SK]
      ,[DT_SK]
      ,[MPRS_PRCS_ID]
      ,[STR_ID]
      ,[FNC_LVL3_PKY_ID]
      ,[ITM_SKU]
      ,[FNC_LVL2_MPRS_CTGRY_ID]
      ,[SBT_FLAG]
      ,CAST([SLS_AMT] AS DECIMAL(18,2)) AS [SLS_AMT]
      ,[SLS_UT_QTY]
      ,[SLS_WGT_QTY]
	  ,CASE WHEN SLS_WGT_QTY <> 0 THEN SLS_WGT_QTY else SLS_UT_QTY END AS SLS_QTY
      ,CAST([PRM_TO_SLS_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_AMT]
      ,[PRM_TO_SLS_QTY]
      ,[PRM_TO_SLS_WGT]
      ,CAST([PRM_TO_SLS_MKDN_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_MKDN_AMT]
	  ,CAST([PRM_TO_SLS_DRCT_MGN_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_DRCT_MGN_AMT]
      ,CAST([CLRNC_SLS_AMT] AS DECIMAL(18,2)) AS [CLRNC_SLS_AMT]
      ,[CLRNC_QTY]
      ,[CLRNC_WGT]
      ,CAST([CLRNC_MKDN_AMT] AS DECIMAL(18,2)) AS [CLRNC_MKDN_AMT]
	  ,CAST([CLRNC_DRCT_MGN_AMT] AS DECIMAL(18,2)) AS [CLRNC_DRCT_MGN_AMT]
	  ,CAST([DRCT_MGN_AMT] AS DECIMAL(18,2)) AS [DRCT_MGN_AMT]
      ,CAST([COGS_AMT] AS DECIMAL(18,2)) AS [COGS_AMT]
      ,CAST([COGS_FNC_CHRG_AMT] AS DECIMAL(18,2)) AS [COGS_FNC_CHRG_AMT]
      ,CAST([COGS_FNC_CR_AMT] AS DECIMAL(18,2)) AS [COGS_FNC_CR_AMT]
      ,CAST([COGS_STRGE_CHRG_AMT] AS DECIMAL(18,2)) AS [COGS_STRGE_CHRG_AMT]
      ,CAST([COGS_FRT_AMT] AS DECIMAL(18,2)) AS [COGS_FRT_AMT]
      ,CAST([COGS_DIST_CNTR_HNDL_AMT] AS DECIMAL(18,2)) AS [COGS_DIST_CNTR_HNDL_AMT]
FROM(
SELECT [PROD_HIST_SK]
      ,[GEO_HIST_SK]
      ,[DT_SK]
      ,[MPRS_PRCS_ID]
      ,[STR_ID]
      ,[FNC_LVL3_PKY_ID]
      ,[ITM_SKU]
      ,[FNC_LVL2_MPRS_CTGRY_ID]
      ,[SBT_FLAG]
      ,[SLS_AMT]
      ,[SLS_QTY] AS SLS_UT_QTY
      ,[SLS_WGT] AS SLS_WGT_QTY
      ,[PRM_TO_SLS_AMT]
      ,[PRM_TO_SLS_QTY]
      ,[PRM_TO_SLS_WGT]
      ,[PRM_TO_SLS_MKDN_AMT]
      ,[CLRNC_SLS_AMT]
      ,[CLRNC_QTY]
      ,[CLRNC_WGT]
      ,[CLRNC_MKDN_AMT]
      ,[COGS_AMT]
      ,[COGS_FNC_CHRG_AMT]
      ,[COGS_FNC_CR_AMT]
      ,[COGS_STRGE_CHRG_AMT]
      ,[DRCT_MGN_AMT]
      ,[PRM_TO_SLS_DRCT_MGN_AMT]
      ,[CLRNC_DRCT_MGN_AMT]
      ,[COGS_FRT_AMT]
      ,[COGS_DIST_CNTR_HNDL_AMT]
  FROM [EDAA_DW].[FCT_DLY_STR_ITMSKU_SLS] WITH(NOLOCK)
)SLS;
