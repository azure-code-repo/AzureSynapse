CREATE VIEW [V_EDAA_DW].[FCT_DLY_STR_ITMSKU_SLS_ADJ_DTL]
AS SELECT [PROD_HIST_SK]
      ,[GEO_HIST_SK]
      ,[DT_SK]
      ,[CR_DT]
      ,[STR_ID]
      ,[ITM_SKU]
      ,CAST([SLS_ADJ_AMT] AS DECIMAL(18,2)) AS [SLS_ADJ_AMT]
      ,[SLS_ADJ_UT_QTY]
      ,[SLS_ADJ_WGT_QTY]
	  ,CASE WHEN SLS_ADJ_WGT_QTY <> 0 THEN SLS_ADJ_WGT_QTY  else SLS_ADJ_UT_QTY  END AS SLS_ADJ_QTY
      ,CAST([PRM_TO_SLS_ADJ_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_ADJ_AMT]
      ,[PRM_TO_SLS_ADJ_QTY]
      ,[PRM_TO_SLS_ADJ_WGT]
      ,CAST([PRM_TO_SLS_MKDN_ADJ_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_MKDN_ADJ_AMT]
	  ,CAST([PRM_TO_SLS_DRCT_MGN_ADJ_AMT] AS DECIMAL(18,2)) AS [PRM_TO_SLS_DRCT_MGN_ADJ_AMT]
      ,CAST([CLRNC_SLS_ADJ_AMT] AS DECIMAL(18,2)) AS [CLRNC_SLS_ADJ_AMT]
      ,[CLRNC_ADJ_QTY]
      ,[CLRNC_ADJ_WGT]
      ,CAST([CLRNC_MKDN_ADJ_AMT] AS DECIMAL(18,2)) AS [CLRNC_MKDN_ADJ_AMT]
	  ,CAST([CLRNC_DRCT_MGN_ADJ_AMT] AS DECIMAL(18,2)) AS [CLRNC_DRCT_MGN_ADJ_AMT]
	  ,CAST([DRCT_MGN_ADJ_AMT] AS DECIMAL(18,2)) AS [DRCT_MGN_ADJ_AMT]
      ,CAST([COGS_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_ADJ_AMT]
      ,CAST([COGS_FNC_CHRG_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_FNC_CHRG_ADJ_AMT]
      ,CAST([COGS_FNC_CR_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_FNC_CR_ADJ_AMT]
      ,CAST([COGS_STRGE_CHRG_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_STRGE_CHRG_ADJ_AMT]
      ,CAST([COGS_FRT_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_FRT_ADJ_AMT]
      ,CAST([COGS_DIST_CNTR_HNDL_ADJ_AMT] AS DECIMAL(18,2)) AS [COGS_DIST_CNTR_HNDL_ADJ_AMT]

FROM
(SELECT [PROD_HIST_SK]
      ,[GEO_HIST_SK]
      ,[DT_SK]
      ,[CR_DT]
      ,[STR_ID]
      ,[ITM_SKU]
      ,[SLS_ADJ_AMT]
      ,[SLS_ADJ_QTY] AS SLS_ADJ_UT_QTY
      ,[SLS_ADJ_WGT] AS SLS_ADJ_WGT_QTY
      ,[PRM_TO_SLS_ADJ_AMT]
      ,[PRM_TO_SLS_ADJ_QTY]
      ,[PRM_TO_SLS_ADJ_WGT]
      ,[PRM_TO_SLS_MKDN_ADJ_AMT]
      ,[CLRNC_SLS_ADJ_AMT]
      ,[CLRNC_ADJ_QTY]
      ,[CLRNC_ADJ_WGT]
      ,[CLRNC_MKDN_ADJ_AMT]
      ,[COGS_ADJ_AMT]
      ,[COGS_FNC_CHRG_ADJ_AMT]
      ,[COGS_FNC_CR_ADJ_AMT]
      ,[COGS_STRGE_CHRG_ADJ_AMT]
      ,[COGS_FRT_ADJ_AMT]
      ,[COGS_DIST_CNTR_HNDL_ADJ_AMT]
      ,[DRCT_MGN_ADJ_AMT]
      ,[PRM_TO_SLS_DRCT_MGN_ADJ_AMT]
      ,[CLRNC_DRCT_MGN_ADJ_AMT]
  FROM [EDAA_DW].[FCT_DLY_STR_ITMSKU_SLS_ADJ] WITH(NOLOCK)
  )SLS_ADJ;
