/****** Object:  View [PRES].[V_FCT_DLY_SL_P_SUB_CT_CALC]    Script Date: 5/21/2021 12:39:35 PM ******/
CREATE VIEW [PRES].[V_FCT_DLY_SL_P_SUB_CT_CALC] AS SELECT
       S.[GEO_HST_SKY]
      ,S.[GEO_SKY]
      ,S.[TM_SKY]
                ,EMP.[MJR_P_SUB_CT_ID] AS P_SUB_CT_ID
      ,S.[BYR_HST_SKY]
      ,S.[BYR_SKY]
      ,S. [UT_ID]
      ,SUM(SLS_PLN_QT) AS SLS_PLN_QT
      ,CAST(SUM([SLS_FNC_AM]) as decimal(11, 2)) AS [SLS_FNC_AM]
      ,SUM([SLS_FNC_QTY]) AS [SLS_FNC_QTY]
      ,CAST(SUM([DM_FNC_AM]) as decimal(11, 2)) AS [DM_FNC_AM]
      ,CAST(SUM([DM_FNC_CLRN_AM]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM]
      ,CAST(SUM([DM_FNC_PROMO_AM]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM]
      ,CAST(SUM([SLS_FNC_CLRN_AM]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM]
      ,CAST(SUM([SLS_FNC_PROMO_AM]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM]
      ,SUM([SLS_FNC_CLRN_QTY])  AS [SLS_FNC_CLRN_QTY]
      ,SUM([SLS_FNC_SCN_QTY])  AS [SLS_FNC_SCN_QTY]
      ,CAST(SUM([INV_SHRK_AM]) as decimal(11, 2)) AS [INV_SHRK_AM]
      ,CAST(SUM([INV_CLRN_QTY]) as decimal(11, 2)) AS  [INV_CLRN_QTY]
      ,CAST(SUM([SLS_FNC_AM_COMP]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP]
      ,CAST(SUM([SLS_FNC_AM_NCOMP]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP]
      ,CAST(SUM([COGS_FNC]) as decimal(11, 2)) AS [COGS_FNC]
      ,CAST(SUM([DM_FNC_RRTL_AM]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM]
      ,CAST(SUM([SLS_FNC_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM]
      ,CAST(SUM([SLS_FNC_AN_PLN_AM]) as decimal(11, 2)) AS [SLS_FNC_AN_PLN_AM]
      ,CAST(SUM([DM_FNC_AN_PLN_AM]) as decimal(11, 2)) AS [DM_FNC_AN_PLN_AM]
      ,CAST(SUM([INV_SHRK_AN_PLN_AM]) as decimal(11, 2)) AS [INV_SHRK_AN_PLN_AM]
      ,CAST(SUM([SLS_FNC_NCLRN_AM]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM]
      ,CAST(SUM([DM_FNC_NCLRN_AM]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM]
      ,CAST(SUM([DM_FNC_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [DM_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM([SLS_FNC_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [SLS_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM([INV_SHRK_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [INV_SHRK_DIFF_TY_VS_AP]
                ,SUM(SLS_PLN_QT_DIFF_TY_VS_AP) AS SLS_PLN_QT_DIFF_TY_VS_AP
      ,CAST(SUM([SLS_FNC_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_CLDR]
      ,SUM([SLS_FNC_QTY_LY_CLDR]) AS [SLS_FNC_QTY_LY_CLDR]
      ,CAST(SUM([DM_FNC_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_CLDR]
      ,SUM([SLS_FNC_CLRN_QTY_LY_CLDR]) AS [SLS_FNC_CLRN_QTY_LY_CLDR]
      ,SUM([SLS_FNC_SCN_QTY_LY_CLDR]) AS [SLS_FNC_SCN_QTY_LY_CLDR]
      ,CAST(SUM([INV_SHRK_AM_LY_CLDR]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_CLDR]
      ,CAST(SUM([INV_CLRN_QTY_LY_CLDR]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_COMP_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_CLDR]
      ,CAST(SUM([COGS_FNC_LY_CLDR]) as decimal(11, 2)) AS [COGS_FNC_LY_CLDR]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_CLDR]

	  ,CAST(SUM([SLS_FNC_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_FSC]
      ,SUM([SLS_FNC_QTY_LY_FSC]) AS [SLS_FNC_QTY_LY_FSC]
      ,CAST(SUM([DM_FNC_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_FSC]
      ,SUM([SLS_FNC_CLRN_QTY_LY_FSC]) AS [SLS_FNC_CLRN_QTY_LY_FSC]
      ,SUM([SLS_FNC_SCN_QTY_LY_FSC]) AS [SLS_FNC_SCN_QTY_LY_FSC]
      ,CAST(SUM([INV_SHRK_AM_LY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_FSC]
      ,CAST(SUM([INV_CLRN_QTY_LY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_COMP_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_FSC]) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LY_FSC]
      ,CAST(SUM([COGS_FNC_LY_FSC]) as decimal(11, 2)) AS [COGS_FNC_LY_FSC]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_FSC]

	  /*LLY*/
	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_QTY_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LLY_FSC]
     ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LLY_FSC]

	 ,CAST(SUM([SLS_FNC_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_HLDY]
      ,SUM([SLS_FNC_QTY_LY_HLDY]) AS [SLS_FNC_QTY_LY_HLDY]
      ,CAST(SUM([DM_FNC_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_HLDY]
      ,SUM([SLS_FNC_CLRN_QTY_LY_HLDY]) AS [SLS_FNC_CLRN_QTY_LY_HLDY]
      ,SUM([SLS_FNC_SCN_QTY_LY_HLDY]) AS [SLS_FNC_SCN_QTY_LY_HLDY]
      ,CAST(SUM([INV_SHRK_AM_LY_HLDY]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_HLDY]
      ,CAST(SUM([INV_CLRN_QTY_LY_HLDY]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_COMP_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_HLDY]
      ,CAST(SUM([COGS_FNC_LY_HLDY]) as decimal(11, 2)) AS [COGS_FNC_LY_HLDY]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_HLDY]) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR])  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR])  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]


      ,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC])  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC])  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      /* LLY Difference */
	  ,CAST(ISNULL(SUM([SLS_FNC_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_QTY]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_AM]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [DM_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_CLRN_AM]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [DM_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_PROMO_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_CLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_CLRN_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_PROMO_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [SLS_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_PROMO_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_CLRN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_SCN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [SLS_FNC_SCN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([INV_SHRK_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([INV_CLRN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_AM_COMP]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_AM_NCOMP]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([COGS_FNC]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([DM_FNC_RRTL_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_RRTL_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_NCLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([DM_FNC_NCLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]


	,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]


  FROM [PRES].[FCT_DLY_SL_P_SUB_CT_CALC] S
  INNER JOIN [PRES].[DIM_P_L3] P
  ON P.[P_HST_SKY] = S.[P_HST_SKY]
  INNER JOIN [dm_edw].[BYR_EMP_PKY_MPRS_CURRPREV_INF] emp
  ON P.FNC_PKY_ID = emp.PKY_ID and emp.MPRS_CT_ID = P.FNC_MPRS_CT_ID
  GROUP BY
  S.[GEO_HST_SKY]
      ,S.[GEO_SKY]
      ,S.[TM_SKY]
                ,EMP.[MJR_P_SUB_CT_ID]
      ,S.[BYR_HST_SKY]
      ,S.[BYR_SKY]
      ,S.[UT_ID]

                union all

                SELECT
       S.[GEO_HST_SKY]
      ,S.[GEO_SKY]
      ,S.[TM_SKY]
       ,'N/A' --[P_SUB_CT_ID]
      ,S.[BYR_HST_SKY]
      ,S.[BYR_SKY]
      ,S.[UT_ID]
                ,SUM(SLS_PLN_QT) AS SLS_PLN_QT
      ,CAST(SUM([SLS_FNC_AM]) as decimal(11, 2)) AS [SLS_FNC_AM]
      ,SUM([SLS_FNC_QTY]) AS [SLS_FNC_QTY]
      ,CAST(SUM([DM_FNC_AM]) as decimal(11, 2)) AS [DM_FNC_AM]
      ,CAST(SUM([DM_FNC_CLRN_AM]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM]
      ,CAST(SUM([DM_FNC_PROMO_AM]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM]
      ,CAST(SUM([SLS_FNC_CLRN_AM]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM]
      ,CAST(SUM([SLS_FNC_PROMO_AM]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM]
      ,SUM([SLS_FNC_CLRN_QTY])  AS [SLS_FNC_CLRN_QTY]
      ,SUM([SLS_FNC_SCN_QTY])  AS [SLS_FNC_SCN_QTY]
      ,CAST(SUM([INV_SHRK_AM]) as decimal(11, 2)) AS [INV_SHRK_AM]
      ,CAST(SUM([INV_CLRN_QTY]) as decimal(11, 2)) AS  [INV_CLRN_QTY]
      ,CAST(SUM([SLS_FNC_AM_COMP]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP]
      ,CAST(SUM([SLS_FNC_AM_NCOMP]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP]
      ,CAST(SUM([COGS_FNC]) as decimal(11, 2)) AS [COGS_FNC]
      ,CAST(SUM([DM_FNC_RRTL_AM]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM]
      ,CAST(SUM([SLS_FNC_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM]
      ,CAST(SUM([SLS_FNC_AN_PLN_AM]) as decimal(11, 2)) AS [SLS_FNC_AN_PLN_AM]
      ,CAST(SUM([DM_FNC_AN_PLN_AM]) as decimal(11, 2)) AS [DM_FNC_AN_PLN_AM]
      ,CAST(SUM([INV_SHRK_AN_PLN_AM]) as decimal(11, 2)) AS [INV_SHRK_AN_PLN_AM]
      ,CAST(SUM([SLS_FNC_NCLRN_AM]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM]
      ,CAST(SUM([DM_FNC_NCLRN_AM]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM]
      ,CAST(SUM([DM_FNC_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [DM_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM([SLS_FNC_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [SLS_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM([INV_SHRK_DIFF_TY_VS_AP]) as decimal(11, 2)) AS [INV_SHRK_DIFF_TY_VS_AP]
                ,SUM(SLS_PLN_QT_DIFF_TY_VS_AP) AS SLS_PLN_QT_DIFF_TY_VS_AP
      ,CAST(SUM([SLS_FNC_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_CLDR]
      ,SUM([SLS_FNC_QTY_LY_CLDR]) AS [SLS_FNC_QTY_LY_CLDR]
      ,CAST(SUM([DM_FNC_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_CLDR]
      ,SUM([SLS_FNC_CLRN_QTY_LY_CLDR]) AS [SLS_FNC_CLRN_QTY_LY_CLDR]
      ,SUM([SLS_FNC_SCN_QTY_LY_CLDR]) AS [SLS_FNC_SCN_QTY_LY_CLDR]
      ,CAST(SUM([INV_SHRK_AM_LY_CLDR]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_CLDR]
      ,CAST(SUM([INV_CLRN_QTY_LY_CLDR]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_COMP_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_CLDR]
      ,CAST(SUM([COGS_FNC_LY_CLDR]) as decimal(11, 2)) AS [COGS_FNC_LY_CLDR]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_CLDR]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_CLDR]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_CLDR]

      ,CAST(SUM([SLS_FNC_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_FSC]
      ,SUM([SLS_FNC_QTY_LY_FSC]) AS [SLS_FNC_QTY_LY_FSC]
      ,CAST(SUM([DM_FNC_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_FSC]
      ,SUM([SLS_FNC_CLRN_QTY_LY_FSC]) AS [SLS_FNC_CLRN_QTY_LY_FSC]
      ,SUM([SLS_FNC_SCN_QTY_LY_FSC]) AS [SLS_FNC_SCN_QTY_LY_FSC]
      ,CAST(SUM([INV_SHRK_AM_LY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_FSC]
      ,CAST(SUM([INV_CLRN_QTY_LY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_FSC]
     ,CAST(SUM([SLS_FNC_AM_COMP_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_FSC]) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LY_FSC]
      ,CAST(SUM([COGS_FNC_LY_FSC]) as decimal(11, 2)) AS [COGS_FNC_LY_FSC]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_FSC]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_FSC]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_FSC]


	  /*LLY*/
	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_QTY_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LLY_FSC]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LLY_FSC]
     ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LLY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LLY_FSC]




	 ,CAST(SUM([SLS_FNC_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_LY_HLDY]
      ,SUM([SLS_FNC_QTY_LY_HLDY]) AS [SLS_FNC_QTY_LY_HLDY]
      ,CAST(SUM([DM_FNC_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_CLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_PROMO_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_HLDY]
      ,SUM([SLS_FNC_CLRN_QTY_LY_HLDY]) AS [SLS_FNC_CLRN_QTY_LY_HLDY]
      ,SUM([SLS_FNC_SCN_QTY_LY_HLDY]) AS [SLS_FNC_SCN_QTY_LY_HLDY]
      ,CAST(SUM([INV_SHRK_AM_LY_HLDY]) as decimal(11, 2)) AS [INV_SHRK_AM_LY_HLDY]
      ,CAST(SUM([INV_CLRN_QTY_LY_HLDY]) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_COMP_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_HLDY]
      ,CAST(SUM([COGS_FNC_LY_HLDY]) as decimal(11, 2)) AS [COGS_FNC_LY_HLDY]
      ,CAST(SUM([DM_FNC_RRTL_AM_LY_HLDY]) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM([DM_FNC_NCLRN_AM_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR])  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR])  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]

      ,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC])  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC])  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]

	  /* LLY Difference */
	  ,CAST(ISNULL(SUM([SLS_FNC_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_QTY]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_AM]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [DM_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_CLRN_AM]),0) - ISNULL(SUM(0),0)as decimal(11, 2)) AS  [DM_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([DM_FNC_PROMO_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_CLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM([SLS_FNC_CLRN_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_PROMO_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [SLS_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_PROMO_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_CLRN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_SCN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [SLS_FNC_SCN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([INV_SHRK_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([INV_CLRN_QTY]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_AM_COMP]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_AM_NCOMP]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([COGS_FNC]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([DM_FNC_RRTL_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_RRTL_MKDN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([SLS_FNC_NCLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM([DM_FNC_NCLRN_AM]),0) - ISNULL(SUM(0),0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]



	 ,CAST(SUM([SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,SUM([SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]) AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([COGS_FNC_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM([DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]


  FROM [PRES].[FCT_DLY_SL_P_SUB_CT_CALC] S
  where s.[P_HST_SKY]=-1

  GROUP BY
  S.[GEO_HST_SKY]
      ,S.[GEO_SKY]
      ,S.[TM_SKY]
      ,S.[BYR_HST_SKY]
      ,S.[BYR_SKY]
      ,S.[UT_ID]
	  UNION ALL
SELECT
       LLY.[GEO_HST_SKY]
      ,LLY.[GEO_SKY]
      ,LLY.[TM_SKY]
                ,LLY.[P_SUB_CT_ID]
      ,LLY.[BYR_HST_SKY]
      ,LLY.[BYR_SKY]
      ,LLY.[UT_ID]
      ,0 AS SLS_PLN_QT
      ,CAST(0 as decimal(11, 2)) AS [SLS_FNC_AM]
      ,0 AS [SLS_FNC_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [INV_CLRN_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_DIFF_TY_VS_AP]
       ,SUM(0) AS SLS_PLN_QT_DIFF_TY_VS_AP
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_CLDR]

	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_FSC]
      ,SUM(0) AS [SLS_FNC_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_FSC]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_FSC]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_FSC]

	  /*LLY*/
	  ,CAST(SUM(LLY.[SLS_FNC_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_QTY_LLY_FSC]) AS [SLS_FNC_QTY_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_CLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_PROMO_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_CLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_CLRN_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_PROMO_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_PROMO_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_CLRN_QTY_LLY_FSC]) AS [SLS_FNC_CLRN_QTY_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_SCN_QTY_LLY_FSC]) AS [SLS_FNC_SCN_QTY_LLY_FSC]
      ,CAST(SUM(LLY.[INV_SHRK_AM_LLY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_LLY_FSC]
      ,CAST(SUM(LLY.[INV_CLRN_QTY_LLY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_LLY_FSC]
     ,CAST(SUM(LLY.[SLS_FNC_AM_COMP_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_AM_NCOMP_LLY_FSC]) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LLY_FSC]
      ,CAST(SUM(LLY.[COGS_FNC_LLY_FSC]) as decimal(11, 2)) AS [COGS_FNC_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_RRTL_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_RRTL_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_NCLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_NCLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LLY_FSC]


	 ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]


      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      /* LLY Difference */
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_QTY_LLY_FSC]),0)as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_AM_LLY_FSC]),0)as decimal(11, 2)) AS  [DM_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_CLRN_AM_LLY_FSC]),0)as decimal(11, 2)) AS  [DM_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_PROMO_AM_LLY_FSC]),0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_PROMO_AM_LLY_FSC]),0) as decimal(11, 2)) AS  [SLS_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_PROMO_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_SCN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS  [SLS_FNC_SCN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[INV_SHRK_AM_LLY_FSC]),0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[INV_CLRN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_COMP_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_NCOMP_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[COGS_FNC_LLY_FSC]),0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_RRTL_AM_LLY_FSC]),0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_RRTL_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_NCLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_NCLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]


	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]


  FROM [PRES].[V_GET_FCT_DLY_SL_P_SUB_CT_CALC_LLY] LLY

  GROUP BY
  LLY.[GEO_HST_SKY]
      ,LLY.[GEO_SKY]
      ,LLY.[TM_SKY]
      ,LLY.[P_SUB_CT_ID]
      ,LLY.[BYR_HST_SKY]
      ,LLY.[BYR_SKY]
      ,LLY.[UT_ID]
Union ALL
SELECT
       LLY.[GEO_HST_SKY]
      ,LLY.[GEO_SKY]
      ,LLY.[TM_SKY]
      ,'N/A'
      ,LLY.[BYR_HST_SKY]
      ,LLY.[BYR_SKY]
      ,LLY.[UT_ID]
      ,0 AS SLS_PLN_QT
      ,CAST(0 as decimal(11, 2)) AS [SLS_FNC_AM]
      ,0 AS [SLS_FNC_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [INV_CLRN_QTY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AN_PLN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_DIFF_TY_VS_AP]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_DIFF_TY_VS_AP]
       ,SUM(0) AS SLS_PLN_QT_DIFF_TY_VS_AP
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_CLDR]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_CLDR]

	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_FSC]
      ,SUM(0) AS [SLS_FNC_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_FSC]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_FSC]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_FSC]

	  /*LLY*/
	  ,CAST(SUM(LLY.[SLS_FNC_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_QTY_LLY_FSC]) AS [SLS_FNC_QTY_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_CLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_PROMO_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_CLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_CLRN_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_PROMO_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_PROMO_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_CLRN_QTY_LLY_FSC]) AS [SLS_FNC_CLRN_QTY_LLY_FSC]
      ,SUM(LLY.[SLS_FNC_SCN_QTY_LLY_FSC]) AS [SLS_FNC_SCN_QTY_LLY_FSC]
      ,CAST(SUM(LLY.[INV_SHRK_AM_LLY_FSC]) as decimal(11, 2)) AS [INV_SHRK_AM_LLY_FSC]
      ,CAST(SUM(LLY.[INV_CLRN_QTY_LLY_FSC]) as decimal(11, 2)) AS [INV_CLRN_QTY_LLY_FSC]
     ,CAST(SUM(LLY.[SLS_FNC_AM_COMP_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_AM_NCOMP_LLY_FSC]) as decimal(11, 2)) As [SLS_FNC_AM_NCOMP_LLY_FSC]
      ,CAST(SUM(LLY.[COGS_FNC_LLY_FSC]) as decimal(11, 2)) AS [COGS_FNC_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_RRTL_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_RRTL_MKDN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[SLS_FNC_NCLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LLY_FSC]
      ,CAST(SUM(LLY.[DM_FNC_NCLRN_AM_LLY_FSC]) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LLY_FSC]



	 ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_CLDR]


      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,SUM(0)  AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,SUM(0)  AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_FSC]
      /* LLY Difference */
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_QTY_LLY_FSC]),0)as decimal(11, 2)) AS  [SLS_FNC_QTY_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_AM_LLY_FSC]),0)as decimal(11, 2)) AS  [DM_FNC_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_CLRN_AM_LLY_FSC]),0)as decimal(11, 2)) AS  [DM_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_PROMO_AM_LLY_FSC]),0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LLY_FSC]
	  ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_PROMO_AM_LLY_FSC]),0) as decimal(11, 2)) AS  [SLS_FNC_PROMO_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_PROMO_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_CLRN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_SCN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS  [SLS_FNC_SCN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[INV_SHRK_AM_LLY_FSC]),0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[INV_CLRN_QTY_LLY_FSC]),0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_COMP_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_AM_NCOMP_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[COGS_FNC_LLY_FSC]),0) as decimal(11, 2)) AS  [COGS_FNC_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_RRTL_AM_LLY_FSC]),0) as decimal(11, 2)) AS  [DM_FNC_RRTL_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_RRTL_MKDN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[SLS_FNC_NCLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]
      ,CAST(ISNULL(SUM(0),0) - ISNULL(SUM(LLY.[DM_FNC_NCLRN_AM_LLY_FSC]),0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LLY_FSC]


	  ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_CLRN_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_PROMO_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,SUM(0) AS [SLS_FNC_SCN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_SHRK_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [INV_CLRN_QTY_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_COMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_AM_NCOMP_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [COGS_FNC_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_RRTL_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_RRTL_MKDN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [SLS_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]
      ,CAST(SUM(0) as decimal(11, 2)) AS [DM_FNC_NCLRN_AM_DIFF_TY_VS_LY_HLDY]


  FROM [PRES].[V_GET_FCT_DLY_SL_P_SUB_CT_CALC_LLY_NULL] LLY

  GROUP BY
       LLY.[GEO_HST_SKY]
      ,LLY.[GEO_SKY]
      ,LLY.[TM_SKY]
      ,LLY.[BYR_HST_SKY]
      ,LLY.[BYR_SKY]
      ,LLY.[UT_ID];
